<!DOCTYPE html><!--[if lt IE 7]><html class="no-js ie ie6 lt-ie7 lt-ie8 lt-ie9 lt-ie10"><![endif]-->
<!--[if IE 7]>   <html class="no-js ie ie7 lt-ie8 lt-ie9 lt-ie10"><![endif]-->
<!--[if IE 8]>   <html class="no-js ie ie8 lt-ie9 lt-ie10"><![endif]-->
<!--[if IE 9]>   <html class="no-js ie ie9 lt-ie10"><![endif]-->
<!--[if gt IE 9]><html class="no-js ie ie10"><![endif]-->
<!--[if !IE]><!-->
<html class="no-js"><!--<![endif]-->
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
    <title>七彩箱</title>
    <!-- Modernizr -->
    <script src="../js/libs/modernizr-2.6.2.min.js"></script>
    <!-- jQuery-->
    <script type="text/javascript" src="../js/libs/jquery-1.10.2.min.js"></script>
    <!-- framework css --><!--[if gt IE 9]><!-->
    <link type="text/css" rel="stylesheet" href="../css/groundwork.css"><!--<![endif]--><!--[if lte IE 9]>
    <link type="text/css" rel="stylesheet" href="../css/groundwork-core.css">
    <link type="text/css" rel="stylesheet" href="../css/groundwork-type.css">
    <link type="text/css" rel="stylesheet" href="../css/groundwork-ui.css">
    <link type="text/css" rel="stylesheet" href="../css/groundwork-anim.css">
    <link type="text/css" rel="stylesheet" href="../css/groundwork-ie.css"><![endif]-->
    <style type="text/css">
      .logo {
        position: relative;
        top: -0.5em;
      }
      .logo a, .logo a:visited {
        text-decoration: none;
        color: #2B2B2D;
      }
      .logo img {
        height: 2em;
        position: relative;
        top: 0.55em;
        margin-right: 0.3em;
      }
      p {
        font-size:12px;
        white-space:nowrap;
        word-wrap:break-word;
        word-break:break-all;
        text-overflow:ellipsis;
        overflow:hidden;
      }
    </style>
    <!-- snippet (syntax highlighting for code examples)-->
    <script type="text/javascript" src="../js/demo/jquery.snippet.min.js"></script>
    <link type="text/css" rel="stylesheet" href="../css/demo/jquery.snippet.css">

    <script type="text/javascript">

    function startMon(type){
        $.get(type);
        alert("ok!");
    }

    function showAllDetail(type){
        var win=null;
        win=window.open("details.html?target="+type,"win","width=800,height=600");
    }

    var httpDiv=0,sql2Div=0,fileDiv=0,codeDiv=0,procDiv=0;
    function showMsg()
    {
        var today = new Date();
        //alert("The time is: " + today.toString ());
        $.getJSON("/refresh",function(result){
            $.each(result, function(i, field){
                if(field.length == 6){return;}
                var head = field.substring(0,6);
                var line = field.substring(6,field.length);
                if(head == "http->"){
                    $("#httpDiv").append('<p class="info dismissible message" title="'+line+'">'+line+'</p>');
                    httpDiv++;
                    $("#httpCol p").html("网络（<font style='color:#F00'>"+httpDiv+"</font>）");
                }else if(head == "sql2->"){
                    $("#sql2Div").append('<p class="info dismissible message" title="'+line+'">'+line+'</p>');
                    sql2Div++;
                    $("#sql2Col p").html("数据库（<font style='color:#F00'>"+sql2Div+"</font>）");
                }else if(head == "file->"){
                    $("#fileDiv").append('<p class="info dismissible message" title="'+line+'">'+line+'</p>');
                    fileDiv++;
                    $("#fileCol p").html("文件（<font style='color:#F00'>"+fileDiv+"</font>）");
                }else if(head == "code->"){
                    line = line.replace('已进入方法: ','-> ');
                    line = line.replace('已退出方法: ','<- ');
                    $("#codeDiv").append('<p class="info dismissible message" title="'+line+'">'+line+'</p>');
                    codeDiv++;
                    $("#codeCol p").html("代码（<font style='color:#F00'>"+codeDiv+"</font>）");
                }else if(head == "proc->"){
                    $("#procDiv").empty();
                    procDiv=0;
                    line = line.split(';pid:');
                    $.each(line, function(i, field){
                        field=$.trim(field);
                        if(field != '' && field.indexOf('[]')==-1 && field.indexOf('None')==-1){
                            $("#procDiv").append('<p class="info message">'+field+'</p>');
                            procDiv++;
                            $("#procCol p").html("进程（<font style='color:#F00'>"+procDiv+"</font>）");
                        }
                    });

                    //$("#procDiv p").html("<a>333</a>");

                }
            });
        });
    }

(function() {

  $(document).ready(function() {

    setInterval ("showMsg()", 2000);

    $('pre[data-lang="html"]').snippet("html", {
      style: "groundwork",
      clipboard: "../js/demo/ZeroClipboard.swf"
    });
    $('pre[data-lang="css"]').snippet("css", {
      style: "groundwork",
      clipboard: "../js/demo/ZeroClipboard.swf"
    });
    $('pre[data-lang="sass"]').snippet("sass", {
      style: "groundwork",
      clipboard: "../js/demo/ZeroClipboard.swf"
    });
    return $('pre[data-lang="js"]').snippet("javascript", {
      style: "groundwork",
      clipboard: "../js/demo/ZeroClipboard.swf"
    });
  });

}).call(this);
</script>
  </head>
  <body>
    <div class="container">
      <div class="row">
        <div class="one whole padded">
          <div class="row">
            <div class="one seventh padded bounceInDown animated">
              <button class="yellow gap-right gap-bottom">智能快照</button>
            </div>
            <div class="one seventh padded bounceInDown animated">
              <button class="yellow gap-right gap-bottom">深度爬虫</button>
            </div>
            <div class="one seventh padded bounceInDown animated">
              <button class="orange gap-right gap-bottom">端口转发</button>
            </div>
            <div class="one seventh padded bounceInDown animated">
              <button class="red gap-right gap-bottom" onclick="startMon('/process/pack/start')">网络抓包</button>
            </div>
            <div class="one seventh padded bounceInDown animated">
              <button class="pink gap-right gap-bottom" onclick="startMon('/process/code/start')">代码调试</button>
            </div>
            <div class="one seventh padded bounceInDown animated">
              <button class="purple gap-right gap-bottom" onclick="startMon('/process/file/start')">文件监控</button>
            </div>
            <div class="one seventh padded bounceInDown animated">
              <button class="blue gap-right gap-bottom" onclick="startMon('/process/all/start')">全部启动</button>
            </div>
          </div>
          <hr>
          <div class="row">
            <div id="httpCol" class="one fifth padded bounceInDown animated">
              <p class="message round align-center" onclick="showAllDetail('httpDiv')">网络（0）</p>
            </div>
            <div id="sql2Col" class="one fifth padded bounceInDown animated">
              <p class="message round align-center" onclick="showAllDetail('sql2Div')">数据库（0）</p>
            </div>
            <div id="codeCol" class="one fifth padded bounceInDown animated">
              <p class="message round align-center" onclick="showAllDetail('codeDiv')">代码（0）</p>
            </div>
            <div id="fileCol" class="one fifth padded bounceInDown animated">
              <p class="message round align-center" onclick="showAllDetail('fileDiv')">文件（0）</p>
            </div>
            <div id="procCol" class="one fifth padded bounceInDown animated">
              <p class="message round align-center" onclick="showAllDetail('procDiv')">进程（0）</p>
            </div>
          </div>
          <div class="row">
            <div id="httpDiv" class="one fifth padded bounceInDown animated">
            </div>
            <div id="sql2Div" class="one fifth padded bounceInDown animated">
            </div>
            <div id="codeDiv" class="one fifth padded bounceInDown animated">
            </div>
            <div id="fileDiv" class="one fifth padded bounceInDown animated">
            </div>
            <div id="procDiv" class="one fifth padded bounceInDown animated">
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- javascript-->
    <script type="text/javascript" src="../js/groundwork.all.js"></script>
  </body>
</html>